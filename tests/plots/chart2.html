<!DOCTYPE html>
<html>
    <head>
        <title>Chart</title>
    </head>
    <body>
        <canvas id="chart"></canvas>

        <script type="module">
            import Chart from 'https://unpkg.com/chart.js@3.6.1/auto/auto.esm.js'
            import { util } from '../../dist/agentscript.js'
            util.toWindow({ Chart, util })

            const ticks = []
            const data1 = []
            const data2 = []
            const data3 = []
            const chart = new Chart('chart', {
                type: 'line',
                data: {
                    labels: ticks,
                    datasets: [
                        {
                            data: data1,
                            label: 'Data1',
                            borderColor: 'red',
                            // tension: 0, // disables bezier curves
                            // showLine: false, // disable for a single dataset
                            // fill: false,
                            // pointRadius: 2.5,
                        },
                        {
                            data: data2,
                            label: 'Data2',
                            borderColor: 'blue',
                        },
                        {
                            data: data3,
                            label: 'Data2',
                            borderColor: 'black',
                        },
                    ],
                },
                options: {
                    // showLines: false,

                    animation: {
                        duration: 0, // general animation time
                    },
                    hover: {
                        animationDuration: 0, // duration of animations when hovering an item
                    },
                    responsiveAnimationDuration: 0, // animation duration after a resize
                    elements: {
                        line: {
                            tension: 0, // disables bezier curves
                            fill: false,
                        },
                        point: {
                            // radius: 10, // default 3
                            // pointStyle: 'cross',
                            // borderWidth: 3,
                        },
                    },
                },
            })

            const increment = 25
            const ranIncr = () => util.randomInt2(-increment, increment)
            util.timeoutLoop(() => {
                ticks.push(ticks.length)
                if (ticks.length === 1) {
                    data1.push(0)
                    data2.push(0)
                    data3.push(0)
                } else {
                    data1.push(util.arrayLast(data1) + ranIncr())
                    data2.push(util.arrayLast(data2) + ranIncr())
                    data3.push(util.arrayLast(data3) + ranIncr())
                }
                chart.update()
            }, 100)
        </script>
    </body>
</html>
